<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    	<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>新增计划</title>
		<link rel="stylesheet" href="../cssAndJs/libs/bootstrap.css"/>
		<link rel="stylesheet" href="../cssAndJs/libs/font-awesome.css"/>
		<link rel="stylesheet" href="../cssAndJs/libs/layui/css/layui.css"/>
		<link rel="stylesheet" href="../cssAndJs/libs/layui/css/modules/laydate/default/laydate.css"/>
		<link rel="stylesheet" href="../cssAndJs/css/base.css"/>
		<link rel="stylesheet" href="../cssAndJs/css/plan_style.css"/>
		<link rel="stylesheet" href="../css/plugins/sweetalert/sweetalert.css"/>
		
		<script type="text/javascript" src="../cssAndJs/libs/layui/layui.js"></script>
		<script type="text/javascript" src="../cssAndJs/libs/jquery.js"></script>
		<script type="text/javascript" src="../js/plugins/sweetalert/sweetalert.min.js"></script>
		<script type="text/javascript" src="../js/jquery-form.js"></script>
		
		<style type="text/css">
			a{color: blue;}
			
			img{
				cursor: pointer;
			    margin: 0 5px;
			}
			
			.custom_form .layui-form-checkbox {
				width: 20px;
				height: 20px;
				line-height: 20px;
				margin: 0;
				padding: 0;
			}
			.custom_form .layui-form-checkbox i {
				width: 20px;
				font-size: 14px;
			}
			
			.search_img{
				padding-bottom: 2px;
				margin-left: -35px;
				cursor: pointer;
			}
			
			.cut_off_line{margin: 20px 0px;}
			
			.checkItem{
				margin-left: 10px;
				cursor: pointer;
			}
		</style>
	</head>
	<!--
	        作者：Jiayan He 
	        时间：2017-10-09
	        描述：新增计划页面
    -->
	<body style="padding-right: 12px;padding-bottom: 12px;height: auto;">
		<div class="plan_layout">
			<form id="saveForm" action="/save_plan.action" method="post" class="layui-form">
				<label>计划信息</label>
				<hr class="layui-bg-orange cut_off_line"/>
				<table border="0" cellspacing="0" cellpadding="0">
					<tr>
						<td>
							<div class="form_item">
								<label>计划类型:</label>
								<div class="input_wrap">
									<span th:switch="${plan.planType}" style="height: 34px;line-height: 34px">
										<span th:case="1">项目类工作计划</span>
										<span th:case="2">日常类工作计划</span>
										<span th:case="3">临时类工作计划</span>
									</span>
									<input type="hidden" id="channel" name="channel" th:value="${channel}"/>
									<input type="hidden" name="flag" id="flag" value=""/>
									<input type="hidden" name="editFlag" id="editFlag" th:value="${editFlag}"/>
									<input type="hidden" id="planId" name="planId" th:value="${plan.planId}"/>
									<input type="hidden" id="planType" name="planType" th:value="${plan.planType}"/>
								</div>
							</div>
						</td>
					</tr>
					<tr>
						<td class="pt_20">
							<div class="form_item">
								<label><span class="star">*</span>计划名称:</label>
								<div class="input_wrap">
									<input type="text" class="layui-input" style="width: 615px;" id="planName" name="planName" th:value="${plan.planName}" placeholder="计划名称限制长度50字"/>
								</div>
							</div>
						</td>
					</tr>
					<tr>
						<td class="pt_20">
							<div class="form_item">
								<label>计划描述:</label>
								<div class="input_wrap">
									<!-- 富文本编辑器 -->
									<textarea class="layui-textarea" style="height: 100px;width: 1025px;" id="planDescribe" name="planDescribe" th:text="${plan.planDescribe}" placeholder="计划简要描述（限制长度为200字节）"></textarea>
									<p class="text-right">(200字节)</p>
								</div>
							</div>
						</td>
					</tr>
					<tr>
						<td class="pt_20">
							<div class="form_item">
								<label><span class="star">*</span>负责人:</label>
								<div class="input_wrap">
									<input type="text" class="layui-input blame" id="blamePerson" name="blamePerson" th:value="${plan.blamePerson}" placeholder="请选择负责人" onclick="chose_blamePerson();"/>
									<img class="search_img" src="../img/search_24.png"/>
								</div>
							</div>
							<div class="form_item" style="margin-left: 50px;">
								<label><span class="star">*</span>负责机构:</label>
								<div class="input_wrap">
									<input type="text" class="layui-input" id="blameOrganization" name="blameOrganization" th:value="${plan.blameOrganization}" placeholder="显示机构" readonly="readonly" style="background-color: #F5F5F5;"/>
								</div>
							</div>
							<div class="form_item" style="margin-left: 44px;">
								<label><span class="star">*</span>负责部门:</label>
								<div class="input_wrap">
									<input type="text" class="layui-input" id="blameSection" name="blameSection" th:value="${plan.blameSection}" placeholder="显示中心+部门" readonly="readonly" style="background-color: #F5F5F5;"/>
								</div>
							</div>
						</td>
					</tr>
					<tr>
						<td class="pt_20">
							<div class="form_item">
								<label>重要程度:</label>
								<div class="input_wrap">
									<input type="radio" name="importance" value="1" title="重要" style="cursor: pointer;" th:checked="${plan.importance} == null" th:if="${plan.importance} == null"/>
									<input type="radio" name="importance" value="1" title="重要" style="cursor: pointer;" th:checked="${plan.importance} == 1" th:if="${plan.importance} != null"/>
					                <input type="radio" name="importance" value="2" title="一般" style="cursor: pointer;" th:checked="${plan.importance} == 2"/>
					                <input type="radio" name="importance" value="3" title="微型" style="cursor: pointer;" th:checked="${plan.importance} == 3"/> 
								</div>
							</div>
							<div class="form_item" style="margin-left: 300px;" th:unless="${plan.planType} == 2">
								<label>客户名称:</label>
								<div class="input_wrap">
									<input type="text" class="layui-input" id="customer" name="customer" th:value="${plan.customer}" placeholder="输入公司法人代表"/>
								</div>
							</div>
						</td>
					</tr>
					<tr th:unless="${plan.planType} == 2">
						<td class="pt_20">
							<div class="form_item">
								<label>特殊类型:</label>
								<div class="input_wrap" style="height: 34px;line-height: 34px">
									<input type="checkbox" id="contractType" name="specialType" value="1" title="合同类计划" style="cursor: pointer;" th:checked="${plan.specialType} == 1" onclick="chose_specialType(1)"/>
									<input type="checkbox" id="houseType" name="specialType" value="2" title="房产类计划" style="cursor: pointer;" th:checked="${plan.specialType} == 2" onclick="chose_specialType(2)"/>
								</div>
							</div>
							<div style="margin-left: 858px;margin-top: -35px;height: 38px;" id="dateRequire">
				   			    <div id="html" th:if="${plan.dateRequire} == null"></div>
			                    <div id="html" class="form_item" th:unless="${plan.dateRequire} == null">
				                   <label for="dateRequire" th:if="${plan.specialType} == 1" style="width: auto;"><span class="star">*</span>合同到期时间:</label>
				                   <label for="dateRequire" th:if="${plan.specialType} == 2" style="width: auto;"><span class="star">*</span>房产交房时间:</label>
				                   <input type="text" class="layui-input laydate_time" name="dateRequire" th:value="${#dates.format(plan.dateRequire,'yyyy-MM-dd')}"/>
			                    </div>
				   			</div>
						</td>
					</tr>
					<tr th:unless="${plan.planType} == 2">
						<td class="pt_20">
							<div class="form_item">
								<label><span class="star">*</span>开始时间:</label>
								<div class="input_wrap">
									<input type="text" class="layui-input laydate_time" id="startTime" name="startTime" th:value="${plan.startTime}" placeholder="年-月-日"/>
								</div>
							</div>
							<div class="form_item" style="margin-left: 462px;">
								<label><span class="star">*</span>结束时间:</label>
								<div class="input_wrap">
									<input type="text" class="layui-input laydate_time" id="endTime" name="endTime" th:value="${plan.endTime}" placeholder="年-月-日"/>
                                    <img th:if="${plan.specialType} == 1" id="remind" style="float: right;margin: 7px 0 0 10px;display: block;" src="../img/remind.png" title="计划结束时间必须比预定的合同时间提前1个月"/>
                                    <img th:if="${plan.specialType} == 2" id="remind" style="float: right;margin: 7px 0 0 10px;display: block;" src="../img/remind.png" title="计划结束时间必须比预定的交房时间提前3个月"/>
                                    <img th:if="${plan.specialType} == null" id="remind" style="float: right;margin: 7px 0 0 10px;display: none;" src="../img/remind.png" title=""/>
								</div>
							</div>
						</td>
					</tr>
					<tr th:if="${plan.planType} == 1">
						<td class="pt_20">
							<div class="form_item">
								<label><span class="star">*</span>计划分解截止时间:</label>
								<div class="input_wrap">
									<input th:if="${plan.pdDeadline} != null" type="text" class="layui-input laydate_time" id="pdDeadline" name="pdDeadline" th:value="${#dates.format(plan.pdDeadline,'yyyy-MM-dd')}" placeholder="年-月-日"/>
									<input th:if="${plan.pdDeadline} == null" type="text" class="layui-input laydate_time" id="pdDeadline" name="pdDeadline" placeholder="年-月-日"/>
								</div>
							</div>
							<div class="form_item" style="margin-left: 462px;">
								<label><span class="star">*</span>计划审批截止时间:</label>
								<div class="input_wrap">
									<input th:if="${plan.papDeadline} != null" type="text" class="layui-input laydate_time" id="papDeadline" name="papDeadline" th:value="${#dates.format(plan.papDeadline,'yyyy-MM-dd')}" placeholder="年-月-日"/>
									<input th:if="${plan.papDeadline} == null" type="text" class="layui-input laydate_time" id="papDeadline" name="papDeadline" placeholder="年-月-日"/>
								</div>
							</div>
						</td>
					</tr>
					<tr>
						<td class="pt_20">
							<div class="form_item">
								<label><span class="star">*</span>完成标准:</label>
								<div class="input_wrap">
									<!-- 富文本编辑器 -->
									<textarea class="layui-textarea" style="height: 100px;width: 1025px;" id="finishStandard" name="finishStandard" th:text="${plan.finishStandard}" placeholder="请描述计划完成后所需达到的标准（限制长度为200字节）"></textarea>
									<p class="text-right">(200字节)</p>
								</div>
							</div>
						</td>
					</tr>
					<!-- <tr th:unless="${plan.planType} == 2">
						<td class="pt_20">
							<div class="form_item">
								<label><span class="star">*</span>节点分解截止时间:</label>
								<div class="input_wrap">
									<input th:if="${plan.ndDeadline} != null" type="text" class="layui-input laydate_time" id="ndDeadline" name="ndDeadline" th:value="${#dates.format(plan.ndDeadline,'yyyy-MM-dd')}" placeholder="年-月-日"/>
									<input th:if="${plan.ndDeadline} == null" type="text" class="layui-input laydate_time" id="ndDeadline" name="ndDeadline" placeholder="年-月-日"/>
								</div>
							</div>
							<div class="form_item" style="margin-left: 462px;">
								<label><span class="star">*</span>节点审批截止时间:</label>
								<div class="input_wrap">
									<input th:if="${plan.napDeadline} != null" type="text" class="layui-input laydate_time" id="napDeadline" name="napDeadline" th:value="${#dates.format(plan.napDeadline,'yyyy-MM-dd')}" placeholder="年-月-日"/>
									<input th:if="${plan.napDeadline} == null" type="text" class="layui-input laydate_time" id="napDeadline" name="napDeadline" placeholder="年-月-日"/>
								</div>
							</div>
						</td>
					</tr> -->
				</table>
				<label style="margin-top: 20px;">考核设置</label>
				<hr class="layui-bg-orange cut_off_line"/>
				<table border="0" cellspacing="0" cellpadding="0" style="margin-top: -20px;" class="custom_form">
					<tr>
						<td class="pt_20">
							<div class="form_item">
								<label><span class="star">*</span>温馨提示:</label>
								<div class="input_wrap">
									<span style="height: 34px;line-height: 34px;">考核类型可多选</span>
								</div>
							</div>
						</td>
					</tr>
					<tr>
						<td class="pt_20">
							<div class="form_item">
								<label>考核类型:</label>
								<div class="input_wrap">
									<span style="height: 34px;line-height: 34px;display: block;">	
										<input th:if="${plan.checkItem} == null" type="checkbox" name="check_item" value="1" onclick="chose_checkItem(1);"/>
										<input th:if="${plan.checkItem} == '2'" type="checkbox" name="check_item" value="1" onclick="chose_checkItem(1);"/>
										<input th:if="${plan.checkItem} == '1'" type="checkbox" name="check_item" value="1" checked="checked" onclick="chose_checkItem(1);"/>
										<input th:if="${plan.checkItem} == '1,2'" type="checkbox" name="check_item" value="1" checked="checked" onclick="chose_checkItem(1);"/>
										<span class="checkItem">计划未按期开始</span>
										<input th:if="${plan.checkItem} == null" type="hidden" id="checkItem" name="checkItem"/>
										<input th:if="${plan.checkItem} == '2'" type="hidden" id="checkItem" name="checkItem"/>
										<input th:if="${plan.checkItem} == '1'" type="hidden" id="checkItem" name="checkItem" value="1"/>
										<input th:if="${plan.checkItem} == '1,2'" type="hidden" id="checkItem" name="checkItem" value="1"/>
									</span>
									<div style="padding-top: 20px;display: inline-block;vertical-align: top;" th:switch="${plan.checkItem}">
										<select th:case="null" id="checkManner_1" name="checkManner" lay-filter="checkManner_1">
											<option value="1">单次考核</option>
											<option value="2">按天累计</option>
										</select>
										<select th:case="'2'" id="checkManner_1" name="checkManner" lay-filter="checkManner_1">
											<option value="1">单次考核</option>
											<option value="2">按天累计</option>
										</select>
										<select th:case="'1'" id="checkManner_1" name="checkManner" lay-filter="checkManner_1">
											<option value="1">单次考核</option>
											<option value="2" th:selected="${plan.pass[0].checkManner} == 2">按天累计</option>
										</select>
										<select th:case="'1,2'" id="checkManner_1" name="checkManner" lay-filter="checkManner_1">
											<option value="1">单次考核</option>
											<option value="2" th:selected="${plan.pass[0].checkManner} == 2">按天累计</option>
										</select>
									</div>
									<div id="checkItem_1" class="form_item" style="display: inline-block;padding-top: 20px;margin-left: 70px;" th:switch="${plan.checkItem}">
										<label><span class="star">*</span>考核金额:</label>
										<div th:case="null" class="input_wrap" id="amount_1">
											<div>
												<input style="width: 100px;" type="text" class="layui-input" name="singleAmount"/>&nbsp;元/次
											</div>
										</div>
										<div th:case="'2'" class="input_wrap" id="amount_1">
											<div>
												<input style="width: 100px;" type="text" class="layui-input" name="singleAmount"/>&nbsp;元/次
											</div>
										</div>
										<div th:case="'1'" class="input_wrap" id="amount_1">
											<div th:if="${plan.pass[0].checkManner} == 1">
												<input style="width: 100px;" type="text" class="layui-input" name="singleAmount" th:value="${plan.pass[0].singleAmount}"/>&nbsp;元/次
											</div>
											<div th:if="${plan.pass[0].checkManner} == 2">
												每延期&nbsp;<img style='position: relative;margin-top: -3px;' src='../img/minus.png' onclick='minus_days(this);'/>
												<input style='width: 140px;margin-left: -37px;text-indent: 40px;' type='text' class='layui-input' name='cumulativeDays' th:value="${plan.pass[0].cumulativeDays}"/>
												<img style='margin: -2px 0 0 -34px;' src='../img/add.png' onclick='add_days(this);'/>&nbsp;天，
												扣款&nbsp;<input style='width: 100px;' type='text' class='layui-input' name='cumulativeAmount' th:value="${plan.pass[0].cumulativeAmount}"/>&nbsp;元
											</div>
										</div>
										<div th:case="'1,2'" class="input_wrap" id="amount_1">
											<div th:if="${plan.pass[0].checkManner} == 1">
												<input style="width: 100px;" type="text" class="layui-input" name="singleAmount" th:value="${plan.pass[0].singleAmount}"/>&nbsp;元/次
											</div>
											<div th:if="${plan.pass[0].checkManner} == 2">
												每延期&nbsp;<img style='position: relative;margin-top: -3px;' src='../img/minus.png' onclick='minus_days(this);'/>
												<input style='width: 140px;margin-left: -37px;text-indent: 40px;' type='text' class='layui-input' name='cumulativeDays' th:value="${plan.pass[0].cumulativeDays}"/>
												<img style='margin: -2px 0 0 -34px;' src='../img/add.png' onclick='add_days(this);'/>&nbsp;天，
												扣款&nbsp;<input style='width: 100px;' type='text' class='layui-input' name='cumulativeAmount' th:value="${plan.pass[0].cumulativeAmount}"/>&nbsp;元
											</div>
										</div>
									</div>
								</div>
							</div>
						</td>
					</tr>
					<tr>
						<td class="pt_20">
							<div class="form_item">
								<label>考核类型:</label>
								<div class="input_wrap">
									<span style="height: 34px;line-height: 34px;display: block;">	
										<input th:if="${plan.checkItem} == null" type="checkbox" name="check_item" value="2" onclick="chose_checkItem(2);"/>
										<input th:if="${plan.checkItem} == '1'" type="checkbox" name="check_item" value="2" onclick="chose_checkItem(2);"/>
										<input th:if="${plan.checkItem} == '2'" type="checkbox" name="check_item" value="2" checked="checked" onclick="chose_checkItem(2);"/>
										<input th:if="${plan.checkItem} == '1,2'" type="checkbox" name="check_item" value="2" checked="checked" onclick="chose_checkItem(2);"/>
										<span class="checkItem">计划未按期完成</span>
										<input th:if="${plan.checkItem} == null" type="hidden" id="checkItems" name="checkItems"/>
										<input th:if="${plan.checkItem} == '1'" type="hidden" id="checkItems" name="checkItems"/>
										<input th:if="${plan.checkItem} == '2'" type="hidden" id="checkItems" name="checkItems" value="2"/>
										<input th:if="${plan.checkItem} == '1,2'" type="hidden" id="checkItems" name="checkItems" value="2"/>
									</span>
									<div style="padding-top: 20px;display: inline-block;vertical-align: top;" th:switch="${plan.checkItem}">
										<select th:case="null" id="checkManner_2" name="checkManners" lay-filter="checkManner_2">
											<option value="1">单次考核</option>
											<option value="2">按天累计</option>
										</select>
										<select th:case="'1'" id="checkManner_2" name="checkManners" lay-filter="checkManner_2">
											<option value="1">单次考核</option>
											<option value="2">按天累计</option>
										</select>
										<select th:case="'2'" id="checkManner_2" name="checkManners" lay-filter="checkManner_2">
											<option value="1">单次考核</option>
											<option value="2" th:selected="${plan.pass[0].checkManner} == 2">按天累计</option>
										</select>
										<select th:case="'1,2'" id="checkManner_2" name="checkManners" lay-filter="checkManner_2">
											<option value="1">单次考核</option>
											<option value="2" th:selected="${plan.pass[1].checkManner} == 2">按天累计</option>
										</select>
									</div>
									<div id="checkItem_2" class="form_item" style="display: inline-block;padding-top: 20px;margin-left: 70px;" th:switch="${plan.checkItem}">
										<label><span class="star">*</span>考核金额:</label>
										<div th:case="null" class="input_wrap" id="amount_2">
											<div>
												<input style="width: 100px;" type="text" class="layui-input" name="singleAmounts"/>&nbsp;元/次
											</div>
										</div>
										<div th:case="'1'" class="input_wrap" id="amount_2">
											<div>
												<input style="width: 100px;" type="text" class="layui-input" name="singleAmounts"/>&nbsp;元/次
											</div>
										</div>
										<div th:case="'2'" class="input_wrap" id="amount_2">
											<div th:if="${plan.pass[0].checkManner} == 1">
												<input style="width: 100px;" type="text" class="layui-input" name="singleAmounts" th:value="${plan.pass[0].singleAmount}"/>&nbsp;元/次
											</div>
											<div th:if="${plan.pass[0].checkManner} == 2">
												每延期&nbsp;<img style='position: relative;margin-top: -3px;' src='../img/minus.png' onclick='minus_days(this);'/>
												<input style='width: 140px;margin-left: -37px;text-indent: 40px;' type='text' class='layui-input' name='cumulativeDayss' th:value="${plan.pass[0].cumulativeDays}"/>
												<img style='margin: -2px 0 0 -34px;' src='../img/add.png' onclick='add_days(this);'/>&nbsp;天，
												扣款&nbsp;<input style='width: 100px;' type='text' class='layui-input' name='cumulativeAmounts' th:value="${plan.pass[0].cumulativeAmount}"/>&nbsp;元
											</div>
										</div>
										<div th:case="'1,2'" class="input_wrap" id="amount_2">
											<div th:if="${plan.pass[1].checkManner} == 1">
												<input style="width: 100px;" type="text" class="layui-input" name="singleAmounts" th:value="${plan.pass[1].singleAmount}"/>&nbsp;元/次
											</div>
											<div th:if="${plan.pass[1].checkManner} == 2">
												每延期&nbsp;<img style='position: relative;margin-top: -3px;' src='../img/minus.png' onclick='minus_days(this);'/>
												<input style='width: 140px;margin-left: -37px;text-indent: 40px;' type='text' class='layui-input' name='cumulativeDayss' th:value="${plan.pass[1].cumulativeDays}"/>
												<img style='margin: -2px 0 0 -34px;' src='../img/add.png' onclick='add_days(this);'/>&nbsp;天，
												扣款&nbsp;<input style='width: 100px;' type='text' class='layui-input' name='cumulativeAmounts' th:value="${plan.pass[1].cumulativeAmount}"/>&nbsp;元
											</div>
										</div>
									</div>
								</div>
							</div>
						</td>
					</tr>
				</table>
				<label style="margin-top: 40px;">子计划</label>
				<hr class="layui-bg-orange cut_off_line"/>
				<div id="container">
					<!-- <div class="container_title">
			   			<label for="">子计划:</label>
			   			<span th:if="${errorCue} != null">
			   				<span th:text="${errorCue}" style="color: red;"></span>
			   				<a th:if="${failure} != 0" th:href="'/check_errorDetail.action?planId='+${plan.planId}+'&amp;editFlag='+${editFlag}" style="text-decoration: underline; color: blue;">查看原因</a>
			   				<span  style="color: red;">。</span>
		   				</span>
			   			<input th:unless="${plan.planType} == 2" class="btn_sm_blue5" type="button" value="excel导入分解" style="float:right;margin-top: -6px;" onclick="import_plan();"/>
		   			</div> -->
		   			<div th:if="${plan.planType} == 2">
						<div class="form_item pt_20">
							<label><span class="star">*</span>计划开始时间:</label>
							<div class="input_wrap">
								<input type="text" class="layui-input laydate_time" id="startTime" name="startTime" th:value="${plan.startTime}" placeholder="年-月-日"/>
							</div>
						</div>
						<div class="form_item" style="margin-left: 55px;">
							<label><span class="star">*</span>计划结束时间:</label>
							<div class="input_wrap">
								<input type="text" class="layui-input laydate_time" id="endTime" name="endTime" th:value="${plan.endTime}" placeholder="年-月-日"/>
							</div>
						</div>
						<div class="form_item">
							<div class="input_wrap" style="padding-bottom: 8px;margin-left: -15px;">
								<span class="star" style="padding-left: 20px;">（计划总周期时间必须要将所有子计划的时间周期包含在内，请先添加子计划再填写主计划开始结束时间）</span>
							</div>
						</div>
						<!-- <input class="btn_sm_blue5" type="button" value="excel导入分解" style="float:right;margin-top: 30px;" onclick="import_plan();"/> -->
					</div>
		   			<table id="listTable" class="table_public" border="0" cellpadding="0" cellspacing="0" style="text-align: center;">
		   				<thead>
		   					<tr>
			   					<th style="width: 271px;">计划名称</th>
			   					<th style="width: 82px;">负责机构</th>
	                            <th style="width: 223px;">负责部门</th>
			   					<th style="width: 73px;">负责人</th>
			   					<th style="width: 182px;">开始时间</th>
			   					<th style="width: 182px;">结束时间</th>
			   					<th style="width: 74px;">工期/天</th>
			   					<th style="width: 316px;">完成标准</th>
			   					<th style="width: 226px;">操作</th>
			   				</tr>
		   				</thead>
		   				<tbody th:if="${plan.subPlans} == null">
		   					<tr>
		   						<td></td>
		   						<td></td>
		   						<td></td>
		   						<td></td>
		   						<td></td>
		   						<td></td>
		   						<td></td>
		   						<td></td>
		   						<td><img src="../img/btn_add.png" title="添加子分解计划" onclick="add_subPlan(0);"/></td>
		   					</tr>
	   					</tbody>
	   					<tbody th:if="${plan.subPlans} != null">
			   				<tr th:each="subPlan,subPlanStat:${plan.subPlans}">
			   					<td style="width: 271px; text-align: left;padding-left: 20px;">
			   						<span class="switch"></span>
	          						<span class="name" th:text="${subPlan.planName}"></span>
	          						<input type="hidden" name="subSum" th:value="${subPlan.subSum}"/>
	          						<input type="hidden" th:id="'count_'+${subPlan.planId}" th:value="${subPlanStat.size}"/>
			   					</td>
			   					<td style="width: 82px;" th:text="${subPlan.blameOrganization}"></td>
			   					<td class="blame" style="width: 223px;text-align: left;padding-left: 20px;" th:text="${subPlan.blameSection}"></td>
			   					<td class="blame" style="width: 73px;" th:text="${subPlan.blamePerson}"></td>
			   					<td style="width: 182px;">
			   						<input type="text" style="width: 120px;" class="layui-input" th:id="'startTime_'+${subPlan.planId}" th:value="${subPlan.startTime}"/>
			   					</td>
			   					<td style="width: 182px;">
			   						<input type="text" style="width: 120px;" class="layui-input" th:id="'endTime_'+${subPlan.planId}" th:value="${subPlan.endTime}"/>
			   					</td>
			   					<td style="width: 74px;" th:text="${subPlan.timeLimit}"></td>
			   					<td style="width: 316px;text-align: left;padding-left: 20px;" th:text="${subPlan.finishStandard}"></td>
			   					<td style="width: 226px;">
			   						<img th:if="${plan.planType} == 2" src="../img/btn_add.png" title="添加子分解计划" th:onclick="'javascript:add_leafSub('+${subPlan.planId}+');'"/>
			   						<img th:if="${plan.planType} != 2" src="../img/btn_add.png" title="添加子分解计划" th:onclick="'javascript:add_subPlan('+${subPlan.planId}+');'"/>
			   						<img src="../img/btn-edit.png" title="编辑" th:onclick="'javascript:edit_plan('+${subPlan.planId}+');'"/>
			   						<img src="../img/btn_time.png" title="修改时间" th:onclick="'javascript:update_time('+${subPlan.planId}+');'"/>
			   						<img src="../img/btn_sort.png" title="调序" th:onclick="'javascript:re_sort('+${subPlan.planId}+');'"/>
			   						<img src="../img/btn-delete.png" title="删除" th:onclick="'javascript:del_subPlan('+${subPlan.planId}+');'"/>
			   					</td>
			   					<tr class="inner" th:if="${subPlan.subPlans} != null">
			   						<td colspan="9">
			   							<table class="list">
			   								<tr th:each="subSubPlan,subSubPlanStat:${subPlan.subPlans}">
							   					<td style="width: 271px; text-align: left;padding-left: 20px;">
							   						<span class="text-indent"></span>
							                		<span class="switch"></span>
							   						<span class="name" th:text="${subSubPlan.planName}"></span>
							   						<input type="hidden" name="subSum" th:value="${subSubPlan.subSum}"/>
							   						<input type="hidden" th:id="'count_'+${subSubPlan.planId}" th:value="${subSubPlanStat.size}"/>
							   					</td>
							   					<td style="width: 82px;" th:text="${subSubPlan.blameOrganization}"></td>
							   					<td class="blame" style="width: 223px;text-align: left;padding-left: 20px;" th:text="${subSubPlan.blameSection}"></td>
							   					<td class="blame" style="width: 73px;" th:text="${subSubPlan.blamePerson}"></td>
							   					<td style="width: 182px;">
							   						<input type="text" style="width: 120px;" class="layui-input" th:id="'startTime_'+${subSubPlan.planId}" th:value="${subSubPlan.startTime}"/>
							   					</td>
							   					<td style="width: 182px;">
							   						<input type="text" style="width: 120px;" class="layui-input" th:id="'endTime_'+${subSubPlan.planId}" th:value="${subSubPlan.endTime}"/>
							   					</td>
							   					<td style="width: 74px;" th:text="${subSubPlan.timeLimit}"></td>
							   					<td style="width: 316px;text-align: left;padding-left: 20px;" th:text="${subSubPlan.finishStandard}"></td>
							   					<td style="width: 226px;">
							   						<img src="../img/btn_add.png" title="添加子分解计划" th:onclick="'javascript:add_subPlan('+${subSubPlan.planId}+');'"/>
							   						<img src="../img/btn-edit.png" title="编辑" th:onclick="'javascript:edit_plan('+${subSubPlan.planId}+');'"/>
							   						<img src="../img/btn_time.png" title="修改时间" th:onclick="'javascript:update_time('+${subSubPlan.planId}+');'"/>
							   						<img src="../img/btn_sort.png" title="调序" th:onclick="'javascript:re_sort('+${subSubPlan.planId}+');'"/>
							   						<img src="../img/btn-delete.png" title="删除" th:onclick="'javascript:del_subPlan('+${subSubPlan.planId}+');'"/>
							   					</td>
							   					<tr class="inner" th:if="${subSubPlan.subPlans} != null">
							   						<td colspan="9">
							   							<table class="list">
							   								<tr th:each="subSubSubPlan,subSubSubPlanStat:${subSubPlan.subPlans}">
											   					<td style="width: 271px; text-align: left;padding-left: 20px;">
											   						<span class="text-indent"></span>
										                      		<span class="text-indent"></span>
										                      		<span class="switch"></span>
											   						<span class="name" th:text="${subSubSubPlan.planName}"></span>
											   						<input type="hidden" name="subSum" th:value="${subSubSubPlan.subSum}"/>
											   						<input type="hidden" th:id="'count_'+${subSubSubPlan.planId}" th:value="${subSubSubPlanStat.size}"/>
											   					</td>
											   					<td style="width: 82px;" th:text="${subSubSubPlan.blameOrganization}"></td>
											   					<td class="blame" style="width: 223px;text-align: left;padding-left: 20px;" th:text="${subSubSubPlan.blameSection}"></td>
											   					<td class="blame" style="width: 73px;" th:text="${subSubSubPlan.blamePerson}"></td>
											   					<td style="width: 182px;">
											   						<input type="text" style="width: 120px;" class="layui-input" th:id="'startTime_'+${subSubSubPlan.planId}" th:value="${subSubSubPlan.startTime}"/>
											   					</td>
											   					<td style="width: 182px;">
											   						<input type="text" style="width: 120px;" class="layui-input" th:id="'endTime_'+${subSubSubPlan.planId}" th:value="${subSubSubPlan.endTime}"/>
											   					</td>
											   					<td style="width: 74px;" th:text="${subSubSubPlan.timeLimit}"></td>
											   					<td style="width: 316px;text-align: left;padding-left: 20px;" th:text="${subSubSubPlan.finishStandard}"></td>
											   					<td style="width: 226px;">
											   						<img src="../img/btn_add.png" title="添加子分解计划" th:onclick="'javascript:add_subPlan('+${subSubSubPlan.planId}+');'"/>
											   						<img src="../img/btn-edit.png" title="编辑" th:onclick="'javascript:edit_plan('+${subSubSubPlan.planId}+');'"/>
											   						<img src="../img/btn_time.png" title="修改时间" th:onclick="'javascript:update_time('+${subSubSubPlan.planId}+');'"/>
											   						<img src="../img/btn_sort.png" title="调序" th:onclick="'javascript:re_sort('+${subSubSubPlan.planId}+');'"/>
											   						<img src="../img/btn-delete.png" title="删除" th:onclick="'javascript:del_subPlan('+${subSubSubPlan.planId}+');'"/>
											   					</td>
											   					<tr class="inner" th:if="${subSubSubPlan.subPlans} != null">
											   						<td colspan="9">
											   							<table class="list">
											   								<tr class="leaf" th:each="subSubSubSubPlan,subSubSubSubPlanStat:${subSubSubPlan.subPlans}">
													                            <td style="width: 271px; text-align: left;padding-left: 20px;">
													                            	<span class="text-indent"></span>
														                      		<span class="text-indent"></span>
														                      		<span class="text-indent"></span>
														                      		<span class="switch"></span>
															   						<span class="name" th:text="${subSubSubSubPlan.planName}"></span>
															   						<input type="hidden" th:id="'count_'+${subSubSubSubPlan.planId}" th:value="${subSubSubSubPlanStat.size}"/>
													                            </td>
													                            <td style="width: 82px;" th:text="${subSubSubSubPlan.blameOrganization}"></td>
															   					<td class="blame" style="width: 223px;text-align: left;padding-left: 20px;" th:text="${subSubSubSubPlan.blameSection}"></td>
															   					<td class="blame" style="width: 73px;" th:text="${subSubSubSubPlan.blamePerson}"></td>
															   					<td style="width: 182px;">
															   						<input type="text" style="width: 120px;" class="layui-input" th:id="'startTime_'+${subSubSubSubPlan.planId}" th:value="${subSubSubSubPlan.startTime}"/>
															   					</td>
															   					<td style="width: 182px;">
															   						<input type="text" style="width: 120px;" class="layui-input" th:id="'endTime_'+${subSubSubSubPlan.planId}" th:value="${subSubSubSubPlan.endTime}"/>
															   					</td>
															   					<td style="width: 74px;" th:text="${subSubSubSubPlan.timeLimit}"></td>
															   					<td style="width: 316px;text-align: left;padding-left: 20px;" th:text="${subSubSubSubPlan.finishStandard}"></td>
															   					<td style="width: 226px;">
															   						<img src="../img/btn_add.png" title="添加子分解计划" th:onclick="'javascript:add_leafSub('+${subSubSubSubPlan.planId}+');'"/>
															   						<img src="../img/btn-edit.png" title="编辑" th:onclick="'javascript:edit_plan('+${subSubSubSubPlan.planId}+');'"/>
															   						<img src="../img/btn_time.png" title="修改时间" th:onclick="'javascript:update_time('+${subSubSubSubPlan.planId}+');'"/>
															   						<img src="../img/btn_sort.png" title="调序" th:onclick="'javascript:re_sort('+${subSubSubSubPlan.planId}+');'"/>
															   						<img src="../img/btn-delete.png" title="删除" th:onclick="'javascript:del_subPlan('+${subSubSubSubPlan.planId}+');'"/>
															   					</td>
															   				</tr>
											   							</table>
											   						</td>
											   					</tr>	
									   						</tr>
							   							</table>
							   						</td>
							   					</tr>
						   					</tr>
			   							</table>
			   						</td>
			   					</tr>
	                       	</tr>
	                   	</tbody>
	                </table>
		   		</div>
		   		<div class="foot_btn_box" style="margin-top: 45px;">
					<span class="btn_sm_blue1" onclick="save_plan()">保存草稿</span>
					<span th:if="${plan.planType} != 2" class="btn_sm_blue1" style="margin-left: 60px;" onclick="save_and_release()">发布任务</span>
					<span th:if="${plan.planType} != 1" class="btn_sm_blue1" style="margin-left: 60px;" onclick="save_and_submit()">提交审批</span>
					<span th:if="${editFlag} == null" class="btn_sm_white3" style="margin-left: 60px;" onclick="cancel();">取消</span>
					<span th:if="${editFlag} != null" class="btn_sm_white3" style="margin-left: 60px;" onclick="cancel_edit();">取消</span>
					<input th:if="${plan.subPlans} != null" type="hidden" id="judge" value="exist"/>
		  			<input th:if="${plan.subPlans} == null" type="hidden" id="judge" value="not_exist"/>
				</div>
			</form>
		</div>
		<!--弹框-->
	    <!--删除-->
	    <div class="alert_3" id="alert_3" style="display: none">
	        <div class="alert_3"><img src="../img/del.jpg"/></div>
	        <p>确认删除本条计划？</p>
	    </div>
	    <!--无法删除 弹框-->
	    <div class="alert_4" id="alert_4" style="display: none">
	        <div class="alert_4">
	            <img src="../img/form_notice.png"/>
	        </div>
	        <p>无法删除，计划存在子计划！</p>
	    </div>
		<div id="popupFormDiv" style="display:none;"></div>
	    <script th:inline="javascript">
	        var flag = [[${flag}]];
	        $(document).ready(function () {
	            if(flag!=null){
                    swal({
                         title : "温馨提示",
                         text : flag
                    });
                    /* layui.use(["form", "laydate"], function () {
						var form = layui.form;
						layer.config({
				            skin: "layer_custom",
				            btnAlign: "c",
				            resize: false
				        });
						layer.confirm('<div class="alert_4" id="alert_4">'+
								        '<div class="alert_4">'+
								            '<img src="../img/form_notice.png"/>'+
								        '</div>'+
								        '<p>'+flag+'</p>'+
								      '</div>', {
				        	btn: false,
				        	area: ["400px", "270px"] 
				        });
					}) */
	            }
	        });
	    </script>
		<script type="text/javascript">
			layui.use(["form", "laydate"], function () {
				var form = layui.form;
				var laydate = layui.laydate;
	
				layer.config({
		            btnAlign: "c",
		            resize: false
		        });
				
				$(".laydate_time").each(function () {
					laydate.render({
						elem: this
					});
				});
				
				form.on('select(checkManner_1)', function(data){
					select_checkManner(1);
				});
				form.on('select(checkManner_2)', function(data){
					select_checkManner(2);
				});
			})
			
			$(".layui-form").on("click", ".layui-form-radio", function () {
				$(this).prev().click();
			})
			
			$(".layui-form").on("click", ".layui-form-checkbox", function () {
				$(this).prev().click();
			})
			
			$(".search_img").on("click", function () {
				$(this).prev().click();
			})
			
			$(".checkItem").on("click", function () {
				$(this).prev("div").click();
			})
		</script>
		<script>
		/*<![CDATA[*/
		  $(".blame").each(function() {
		  	if($(this).text().indexOf("请重新指定！") > 0 || $(this).val().indexOf("请重新指定！") > 0){
		  		$(this).css("color", "lightgrey");
		  	}
		  });
		  
		  $("input[name='subSum']").each(function() {
		  	 	if($(this).val() != ""){
		  	 		$(this).parent().parent().addClass("outer");
		  	 	}else{
		  	 		$(this).parent().parent().addClass("leaf");
		  	 	}
		  	 });
		  	 
	  	  $(".outer").addClass("open").next(".inner").addClass("open");
		  
		  $(".switch").click(function(){
		    if($(this).parents(".outer").is(".open")){
		      $(this).parents(".outer").removeClass("open").next(".inner").removeClass("open");
		    }else{
		      $(this).parents(".outer").addClass("open").next(".inner").addClass("open");
		    }
		  });
		
		  $("tr.outer, tr.leaf").click(function(){
		    $("tr.focus").removeClass("focus");
		    $(this).addClass("focus");
		  });
		/*]]>*/
		</script>
	</body>
	<script type="text/javascript">
	  	/*<![CDATA[*/
	  	function add_subPlan(val){
	  		var editFlag = $("#editFlag").val();
	  		if(val == "0"){
	  			//给一个新增子计划的标识
		  		$("#flag").val("addSub");
		  		$("#saveForm").submit();
	  		} else {
		  		layer.open({
				    type: 2,
			        title: '选择计划路径',
			        skin: 'layui-layer-molv',
			        shadeClose: true,
			        shade: 0.3,
			        maxmin: false, //关闭最大化最小化按钮
			        area: ['580px', '270px'],
			        content: ['/chose_add_location.action?planId='+val+'&&editFlag='+editFlag,'no'],
			        end: function(){
						// 如果是通过单击关闭按钮关闭弹出层，父画面没有此表单
						if($("#myForm").length === 1){
							$("#myForm").submit();
						} 
					}
		  		});
	  		}
	  	}
	  	
	  	function add_leafSub(val){
	  		var editFlag = $("#editFlag").val();
	  		layer.open({
			    type: 2,
		        title: '选择计划路径',
		        skin: 'layui-layer-molv',
		        shadeClose: true,
		        shade: 0.3,
		        maxmin: false, //关闭最大化最小化按钮
		        area: ['580px', '270px'],
		        content: ['/chose_add_location.action?planId='+val+'&&editFlag='+editFlag+'&&subFlag=leaf','no'],
		        end: function(){
					// 如果是通过单击关闭按钮关闭弹出层，父画面没有此表单
					if($("#myForm").length === 1){
						$("#myForm").submit();
					} 
				}
	  		});
	  	}
	  	
	  	function update_time(planId){
	  		var editFlag = $("#editFlag").val();
	  		var startTime = $("#startTime_"+planId).val();
	  		var startTimeDaily = $("#startTimeDaily_"+planId).val();
	  		var endTime = $("#endTime_"+planId).val();
	  		var endTimeDaily = $("#endTimeDaily_"+planId).val();
	  		layer.confirm('确认修改本条计划的时间？', {
	        btn: ['确定','取消'] 
	        }, function(){
	        	window.location.href="/update_time.action?planId="+planId+"&&startTime="+startTime+"&&startTimeDaily="+startTimeDaily+"&&endTime="+endTime+"&&endTimeDaily="+endTimeDaily+"&&editFlag="+editFlag;
	        });
	  	}
	  	
	  	function edit_plan(planId){
	  		var editFlag = $("#editFlag").val();
	  		window.location.href="/edit_plan.action?planId="+planId+"&&editFlag="+editFlag;
	  	}
	  	
	  	function re_sort(planId){
	  		var count = $("#count_"+planId).val();
	  		var editFlag = $("#editFlag").val();
	  		if(count > 1){
		  		window.location.href="/re_sort_plan.action?planId="+planId+"&&editFlag="+editFlag;
	  		}else{
	  			layer.msg("当前层仅有一条子计划，无法进行排序！");
	  		}
	  	}
	  	
	    function del_subPlan(planId){
	        var editFlag = $("#editFlag").val();
	        layer.confirm($("#alert_3").html(), {
		        btn: ['确定','取消'],
		        area: ["400px", "270px"], 
	        }, function(){
	        	window.location.href="/delete_subPlan.action?planId="+planId+"&&editFlag="+editFlag;
	        }); 
	    }
	  	
	  	function save_plan(){
	  		$("#flag").val("save");
	  		$("#saveForm").submit();
	  	}
	  	
	  	function save_and_release(){
	  		if($("#judge").val() == "not_exist"){
	  			layer.msg("请先添加子分解计划，然后再发布！");
	  		}else{
		  		$("#flag").val("release");
		  		$("#saveForm").submit();
	  		}
	  	}
	  	
	  	function save_and_submit(){
	  		$("#flag").val("submit");
	  		$("#saveForm").submit();
	  	}
	  	
	  	function cancel(){
	  		var planId = $("#planId").val();
	  		var channel = $("#channel").val();
	  		window.location.href="/cancel_add.action?planId="+planId+"&channel="+channel;
	  	}
	  	
	  	function cancel_edit(){
	  		var planType = $("#planType").val();
	  		window.location.href="/find_drafts_0_10_0.action?planType="+planType;
	  	}
	  	
	  	function import_plan(){
	        if($("#judge").val() == "not_exist"){
	        	if($("#planType").val() == 2){
		  			var loopRate = $("#rate").val();
		  			var startTime = $("#startTime").val();
		  			var endTime = $("#endTime").val();
		  			console.log(loopRate);
		  			var index = layer.confirm();
		  			layer.confirm('请在操作导入功能前，优先确认循环方式和循环频率已经填写,并且计划开始执行时间及结束时间不能为空！', {
			        	btn: ['确定','返回'] 
			        }, function(index){
			        	if(loopRate != "" && startTime != "" && endTime != ""){
			        		var options = { 
						        url:'/save_mainPlan.action', 
						        type:'POST',
						        success:function(data){
						            var planId = "";
						            var editFlag = "";
						            if(data.indexOf("-") > 0){
						            	planId = data.substring(0, data.lastIndexOf("-"));
						            	editFlag = data.substring(data.lastIndexOf("-")+1, data.length);
						            }else{
						            	planId = data;
					            	}
						            $("#planId").val(planId);
						            layer.open({
						                type: 2,
						                title: '选择文档',
						                skin: 'layui-layer-molv',
						                shadeClose: true,
						                shade: 0.3,
						                area: ['520px', '275px'],
						                content: ['/chose_file.action?planId='+planId+'&&editFlag='+editFlag,'no']
							        }); 
						        }
					        }; 
					        $("#saveForm").ajaxSubmit(options); 
					        layer.close(index);
			        	}else{
			        		layer.close(index);
			        	}
			        });
		  		}else{
		  			var startTime = $("#startTime").val();
		  			var endTime = $("#endTime").val();
		  			if(startTime != "" && endTime != ""){
		  				var options = { 
					        url:'/save_mainPlan.action', 
					        type:'POST',
					        success:function(data){
					            var planId = "";
					            var editFlag = "";
					            if(data.indexOf("-") > 0){
					            	planId = data.substring(0, data.lastIndexOf("-"));
					            	editFlag = data.substring(data.lastIndexOf("-")+1, data.length);
					            }else{
					            	planId = data;
					            }
					            $("#planId").val(planId);
					            layer.open({
					                type: 2,
					                title: '选择文档',
					                skin: 'layui-layer-molv',
					                shadeClose: true,
					                shade: 0.3,
					                area: ['520px', '275px'],
					                content: ['/chose_file.action?planId='+planId+'&&editFlag='+editFlag,'no']
						        });
					        }
				        }; 
				        $("#saveForm").ajaxSubmit(options); 
				        return false;
		  			}else{
		  				layer.msg("请先填写计划开始时间以及结束时间！");
		  			}
		  		}
	        }else if($("#judge").val() == "exist"){
	        	layer.msg("子计划列表已有内容，若需要导入数据，请将子计划列表清空！");
	        }
	  	} 
	  	
	  	function reload_data(planId,editFlag,flag){
	  		if(flag == 'success'){
	  			var index = layer.load(1, {
					shade: [0.1,'#fff'], //0.1透明度的白色背景
					time: 1500
				})
	  			setTimeout(function() {
		  			window.location.href="/reload_data.action?planId="+planId+"&&editFlag="+editFlag;
	  			}, 3000); 	
	  		}
	  	}
	  	
	  	function chose_specialType(val){
	  		var html1 = "<div id='html' class='form_item'>"
	                    +"<label style='width: auto;'><span class='star'>*</span>合同到期时间:</label>"
	                    +"<input type='text' class='layui-input laydate_time' name='dateRequire' th:value='${#dates.format(plan.dateRequire,'yyyy-MM-dd')}'/></div>";
	        var html2 = "<div id='html' class='form_item'>"
	                    +"<label style='width: auto;'><span class='star'>*</span>预定交房时间:</label>"
	                    +"<input type='text' class='layui-input laydate_time' name='dateRequire' th:value='${#dates.format(plan.dateRequire,'yyyy-MM-dd')}'/></div>";
		  	$("input[name='specialType']").each(function(){
				if($(this).val() == val){
					if($(this).attr("checked")!=undefined){
		        		$(this).attr("checked", false);
		        		$("#html").remove();
		        		$(this).next().removeClass("layui-form-checked");
		        		$("#remind").css("display", "none");
		        	}else{
		        		$(this).attr("checked", true);
		        		$("#remind").css("display", "block");
		        		$("#html").remove();
						if(val == 1){
							$("#dateRequire").append(html1);
							$("#remind").attr("title", "计划结束时间必须比预定的合同时间提前1个月");
						}else{
							$("#dateRequire").append(html2);
							$("#remind").attr("title", "计划结束时间必须比预定的交房时间提前3个月");
						}
		        	}
				}else{
					$(this).attr("checked", false);
					$(this).next().removeClass("layui-form-checked");
				}
			});
			
			layui.use(["form", "laydate"], function () {
				var form = layui.form;
				var laydate = layui.laydate;
	
				$(".laydate_time").each(function () {
					laydate.render({
						elem: this
					});
				});
			})
	  	}
	  	
	  	function chose_blamePerson(){
	  		layer.open({
	  			type: 2,
	            title: '选择负责人',
	            skin: 'layui-layer-molv',
	            shadeClose: true,
	            shade: 0.3,
	            area: ['680px', '750px'],
	            content: ['/chose_blamePerson.action','no']
	  		});
	  	}
	  	
	  	function select_checkManner(val){
	  		var checkManner = null;
	  		if(val == 1){
		  		checkManner = $("#checkManner_1").val();
		  		if(checkManner == 1){
		  			$("#amount_1").remove();
		  			$("#checkItem_1").append("<div class='input_wrap' id='amount_1'><div>"+
												"<input style='width: 100px;' type='text' class='layui-input' name='singleAmount'/>&nbsp;元/次"+
											 "</div></div>");
		  		}else if(checkManner == 2){
		  			$("#amount_1").remove();
		  			$("#checkItem_1").append("<div class='input_wrap' id='amount_1'><div>"+
												"每延期&nbsp;<img style='position: relative;margin-top: -3px;' src='../img/minus.png' onclick='minus_days(this);'/>"+
												"<input style='width: 140px;margin-left: -37px;text-indent: 40px;' type='text' class='layui-input' name='cumulativeDays' value='1'/>"+
												"<img style='margin: -2px 0 0 -34px;' src='../img/add.png' onclick='add_days(this);'/>&nbsp;天，"+
												"扣款&nbsp;<input style='width: 100px;' type='text' class='layui-input' name='cumulativeAmount'/>&nbsp;元"+
											 "</div></div>");
		  		}
	  		}else if(val == 2){
		  		checkManner = $("#checkManner_2").val();
		  		if(checkManner == 1){
		  			$("#amount_2").remove();
		  			$("#checkItem_2").append("<div class='input_wrap' id='amount_2'><div>"+
												"<input style='width: 100px;' type='text' class='layui-input' name='singleAmounts'/>&nbsp;元/次"+
											 "</div></div>");
		  		}else if(checkManner == 2){
		  			$("#amount_2").remove();
		  			$("#checkItem_2").append("<div class='input_wrap' id='amount_2'><div>"+
												"每延期&nbsp;<img style='position: relative;margin-top: -3px;' src='../img/minus.png' onclick='minus_days(this);'/>"+
												"<input style='width: 140px;margin-left: -37px;text-indent: 40px;' type='text' class='layui-input' name='cumulativeDayss' value='1'/>"+
												"<img style='margin: -2px 0 0 -34px;' src='../img/add.png' onclick='add_days(this);'/>&nbsp;天，"+
												"扣款&nbsp;<input style='width: 100px;' type='text' class='layui-input' name='cumulativeAmounts'/>&nbsp;元"+
											 "</div></div>");
		  		}
	  		}
	  	}
	  	/*]]>*/
	  </script>
	  <script type="text/javascript">
		/*<![CDATA[*/
	   function chose_checkItem(val){
	    	$("input[name='check_item']").each(function(){    
		        if($(this).val() == val){    
		        	if($(this).attr("checked")!=undefined){
		        		$(this).attr("checked", false);
		        		$(this).siblings().removeClass("layui-form-checked");
		        		if(val == 1){
		        			$("#checkItem").val("");
		        		}else if(val == 2){
		        			$("#checkItems").val("");
		        		}
		        	}else{
		        		$(this).attr("checked", true);
		        		if(val == 1){
		        			$("#checkItem").val(val);
		        		}else if(val == 2){
		        			$("#checkItems").val(val);
		        		}
		        	}
		        }
	        }); 
	    }
	    
	    function minus_days(othis){
	    	var days = $(othis).next().val();
	    	if(days > 0){
	    		$(othis).next().val(days - 1);
	    	}else{
	    		$(othis).next().val(0);
	    	}
	    	
	    }
	    function add_days(othis){
	    	var days = $(othis).prev().val();
	    	$(othis).prev().val(days - 1 + 2);
	    }
	   /*]]>*/
  	</script>
</html>
